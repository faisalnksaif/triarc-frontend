import{_ as a,k as e}from"./index-DpKSFPTT.js";import{h as o,H as r,y as i,a0 as t,a6 as n,a8 as c,x as s,P as l,Z as d,ac as m,n as p,V as u,a7 as v,o as b,af as y}from"./vendor-CMm6NMdo.js";import{$ as k}from"./vuetify-HNwo1rVu.js";const g={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_MAPBOX_TOKEN:"pk.eyJ1IjoiZmFpc2FsbmtzYWlmIiwiYSI6ImNqYjVxbTBzNjM5bXgzMnM3aGhyODRjbGIifQ.5SWtkY-xfdtuKX7Jq2gV5g"},h={class:"section-title text-center mt-15 mb-10"},f={class:"map-wrapper"},x={key:0,class:"map-fallback"},w={class:"fallback-text"},M=a({__name:"ActiveAreasMap",props:{accessToken:{type:String,default:""}},setup(a){const M=a,j=o(null),I=o(null);let P;const B=o(""),E=o(!1),C=o(!1),{mobile:z}=k(),S=[{id:"mysore",name:"Mysore",coords:[76.6394,12.2958]},{id:"bangalore",name:"Bangalore",coords:[77.5946,12.9716]},{id:"bangalore-kanakpura",name:"Bangalore - Kanakpura",coords:[77.4188,12.5466]},{id:"bangalore-sarjapur",name:"Bangalore - Sarjapur",coords:[77.7835,12.8628]},{id:"bangalore-devanahalli",name:"Bangalore - Devanahalli",coords:[77.711,13.246]},{id:"bangalore-whitefield",name:"Bangalore - Whitefield",coords:[77.7499,12.9698]},{id:"bangalore-chikkathirupathi",name:"Bangalore - Chikkathirupathi",coords:[77.905,12.8735]},{id:"coimbatore",name:"Coimbatore",coords:[76.9558,11.0168]},{id:"coimbatore-nallampalayam",name:"Coimbatore - Nallampalayam",coords:[76.9516,11.0723]},{id:"coimbatore-kalapatti",name:"Coimbatore - Kalapatti",coords:[77.0265,11.0654]},{id:"madurai",name:"Madurai",coords:[78.1198,9.9252]},{id:"mettupalayam",name:"Mettupalayam",coords:[76.9348,11.2997]},{id:"sirumugai",name:"Sirumugai",coords:[77.0015,11.3215]},{id:"thrissur",name:"Thrissur",coords:[76.2144,10.5276]},{id:"adatt",name:"Adatt",coords:[76.152,10.605]},{id:"ernakulam",name:"Ernakulam",coords:[76.2999,9.9816]},{id:"edapally",name:"Edapally",coords:[76.307,10.029]},{id:"maradu",name:"Maradu",coords:[76.3299,9.9386]},{id:"kozhikode",name:"Kozhikode",coords:[75.7804,11.2588]},{id:"chevarambalam",name:"Chevarambalam",coords:[75.826,11.277]},{id:"pantheerankavu",name:"Pantheerankavu",coords:[75.8439,11.2196]},{id:"malappuram",name:"Malappuram",coords:[76.0711,11.051]},{id:"vengara",name:"Vengara",coords:[75.9642,11.0496]},{id:"tirurangadi",name:"Tirurangadi",coords:[75.9552,11.1111]},{id:"achanambalam",name:"Achanambalam",coords:[75.926,11.05]},{id:"kottakal",name:"Kottakal",coords:[76.0003,10.994]},{id:"melattur",name:"Melattur",coords:[76.2667,11.0667]},{id:"manjeri",name:"Manjeri",coords:[76.1196,11.1187]},{id:"pandimuttam",name:"Pandimuttam",coords:[76.064,10.991]},{id:"moonniyoor",name:"Moonniyoor",coords:[75.9064,11.1135]},{id:"palakkad",name:"Palakkad",coords:[76.6548,10.7867]}];async function _(){B.value="";try{if(!j.value)throw new Error("Map container not ready");const r="v2.15.0";window.mapboxgl||(await(e="mapbox-gl-css",o=`https://api.mapbox.com/mapbox-gl-js/${r}/mapbox-gl.css`,new Promise(a=>{if(document.getElementById(e))return a();const r=document.createElement("link");r.id=e,r.rel="stylesheet",r.href=o,r.onload=()=>a(),document.head.appendChild(r)})),await(a=`https://api.mapbox.com/mapbox-gl-js/${r}/mapbox-gl.js`,new Promise((e,o)=>{const r=document.createElement("script");r.src=a,r.async=!0,r.defer=!0,r.onload=()=>e(),r.onerror=a=>o(a),document.body.appendChild(r)})));const i=M.accessToken||g&&"pk.eyJ1IjoiZmFpc2FsbmtzYWlmIiwiYSI6ImNqYjVxbTBzNjM5bXgzMnM3aGhyODRjbGIifQ.5SWtkY-xfdtuKX7Jq2gV5g"||"";if(!i)return void(B.value="Map cannot load: missing Mapbox token.");if(window.mapboxgl.accessToken=i,P){try{P.remove()}catch{}P=null}P=new window.mapboxgl.Map({container:j.value,style:"mapbox://styles/mapbox/dark-v11",center:[77.5,12.5],zoom:0,maxZoom:0,attributionControl:!1,scrollZoom:!1,doubleClickZoom:!1,touchZoom:!0,dragPan:!1,dragRotate:!1,keyboard:!1}),P.on("load",()=>{C.value=!0;const a=new window.mapboxgl.LngLatBounds,e={type:"FeatureCollection",features:S.map(a=>({type:"Feature",properties:{name:a.name},geometry:{type:"Point",coordinates:a.coords}}))};S.forEach(e=>{a.extend(e.coords)}),P.addSource("active-circles",{type:"geojson",data:e}),P.addLayer({id:"active-circles-pulse",type:"circle",source:"active-circles",paint:{"circle-radius":10,"circle-color":"#aa8453","circle-opacity":.3,"circle-blur":.5}}),P.addLayer({id:"active-circles-layer",type:"circle",source:"active-circles",paint:{"circle-radius":3,"circle-color":"#aa8453","circle-opacity":.5,"circle-stroke-width":0,"circle-stroke-color":"#aa8453","circle-stroke-opacity":.8}});let o=4,r=!0;const i=()=>{r?(o+=.15,o>=7&&(r=!1)):(o-=.15,o<=4&&(r=!0)),P.setPaintProperty("active-circles-pulse","circle-radius",o),P.setPaintProperty("active-circles-pulse","circle-opacity",.4-.08*(o-4)),requestAnimationFrame(i)};i(),a.isEmpty()||P.fitBounds(a,{padding:10,maxZoom:0,duration:1200})}),P.on("error",a=>{B.value="Map failed to load. Please retry or check network."})}catch(r){B.value="Map initialization failed."}var a,e,o}return r(()=>{if(I.value){const a=new IntersectionObserver(([e])=>{e.isIntersecting&&!E.value&&(E.value=!0,a.unobserve(e.target))},{threshold:.1});a.observe(I.value)}_()}),i([E,C],([a,e])=>{a&&e&&P&&setTimeout(()=>{const a=Date.now(),e=z.value?8:7,o=(z.value,6.5),r=()=>{const i=Date.now()-a,t=Math.min(i/1e3,1),n=t*o,c=t*e;P.setZoom(n),P.setMaxZoom(c),t<1&&requestAnimationFrame(r)};r()},100)}),t(()=>{P&&P.remove()}),(a,o)=>{const r=y("motion");return c(),n("section",{ref_key:"sectionRef",ref:I,id:"active-areas",class:b(["active-areas-section",{"is-visible":E.value}])},[s("div",null,[l((c(),n("h2",h,[...o[0]||(o[0]=[d("Active Locations",-1)])])),[[r,void 0,"fadeInUp"]]),s("div",f,[s("div",{ref_key:"mapContainer",ref:j,class:"map-container"},null,512),B.value?(c(),n("div",x,[s("p",w,u(B.value),1),p(e,{color:"primary",size:"small",class:"mt-4",onClick:_},{default:v(()=>[...o[1]||(o[1]=[d("Retry",-1)])]),_:1})])):m("",!0)])])],2)}}},[["__scopeId","data-v-e350da49"]]);export{M as default};
