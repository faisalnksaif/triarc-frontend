import{_ as a,k as e}from"./index-CzfBSuD8.js";import{h as o,H as r,y as i,a0 as t,a6 as n,a8 as c,x as s,ac as l,n as d,V as m,a7 as p,Z as u,o as y}from"./vendor-CMm6NMdo.js";import{$ as b}from"./vuetify-HNwo1rVu.js";const v={BASE_URL:"/triarc-frontend/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_MAPBOX_TOKEN:"pk.eyJ1IjoiZmFpc2FsbmtzYWlmIiwiYSI6ImNqYjVxbTBzNjM5bXgzMnM3aGhyODRjbGIifQ.5SWtkY-xfdtuKX7Jq2gV5g"},k={class:"map-wrapper"},g={key:0,class:"map-fallback"},h={class:"fallback-text"},f=a({__name:"ActiveAreasMap",props:{accessToken:{type:String,default:""}},setup(a){const f=a,x=o(null),w=o(null);let M;const j=o(""),I=o(!1),P=o(!1),{mobile:B}=b(),E=[{id:"mysore",name:"Mysore",coords:[76.6394,12.2958]},{id:"bangalore",name:"Bangalore",coords:[77.5946,12.9716]},{id:"bangalore-kanakpura",name:"Bangalore - Kanakpura",coords:[77.4188,12.5466]},{id:"bangalore-sarjapur",name:"Bangalore - Sarjapur",coords:[77.7835,12.8628]},{id:"bangalore-devanahalli",name:"Bangalore - Devanahalli",coords:[77.711,13.246]},{id:"bangalore-whitefield",name:"Bangalore - Whitefield",coords:[77.7499,12.9698]},{id:"bangalore-chikkathirupathi",name:"Bangalore - Chikkathirupathi",coords:[77.905,12.8735]},{id:"coimbatore",name:"Coimbatore",coords:[76.9558,11.0168]},{id:"coimbatore-nallampalayam",name:"Coimbatore - Nallampalayam",coords:[76.9516,11.0723]},{id:"coimbatore-kalapatti",name:"Coimbatore - Kalapatti",coords:[77.0265,11.0654]},{id:"madurai",name:"Madurai",coords:[78.1198,9.9252]},{id:"mettupalayam",name:"Mettupalayam",coords:[76.9348,11.2997]},{id:"sirumugai",name:"Sirumugai",coords:[77.0015,11.3215]},{id:"thrissur",name:"Thrissur",coords:[76.2144,10.5276]},{id:"adatt",name:"Adatt",coords:[76.152,10.605]},{id:"ernakulam",name:"Ernakulam",coords:[76.2999,9.9816]},{id:"edapally",name:"Edapally",coords:[76.307,10.029]},{id:"maradu",name:"Maradu",coords:[76.3299,9.9386]},{id:"kozhikode",name:"Kozhikode",coords:[75.7804,11.2588]},{id:"chevarambalam",name:"Chevarambalam",coords:[75.826,11.277]},{id:"pantheerankavu",name:"Pantheerankavu",coords:[75.8439,11.2196]},{id:"malappuram",name:"Malappuram",coords:[76.0711,11.051]},{id:"vengara",name:"Vengara",coords:[75.9642,11.0496]},{id:"tirurangadi",name:"Tirurangadi",coords:[75.9552,11.1111]},{id:"achanambalam",name:"Achanambalam",coords:[75.926,11.05]},{id:"kottakal",name:"Kottakal",coords:[76.0003,10.994]},{id:"melattur",name:"Melattur",coords:[76.2667,11.0667]},{id:"manjeri",name:"Manjeri",coords:[76.1196,11.1187]},{id:"pandimuttam",name:"Pandimuttam",coords:[76.064,10.991]},{id:"moonniyoor",name:"Moonniyoor",coords:[75.9064,11.1135]},{id:"palakkad",name:"Palakkad",coords:[76.6548,10.7867]}];async function C(){j.value="";try{if(!x.value)throw new Error("Map container not ready");const r="v2.15.0";window.mapboxgl||(await(e="mapbox-gl-css",o=`https://api.mapbox.com/mapbox-gl-js/${r}/mapbox-gl.css`,new Promise(a=>{if(document.getElementById(e))return a();const r=document.createElement("link");r.id=e,r.rel="stylesheet",r.href=o,r.onload=()=>a(),document.head.appendChild(r)})),await(a=`https://api.mapbox.com/mapbox-gl-js/${r}/mapbox-gl.js`,new Promise((e,o)=>{const r=document.createElement("script");r.src=a,r.async=!0,r.defer=!0,r.onload=()=>e(),r.onerror=a=>o(a),document.body.appendChild(r)})));const i=f.accessToken||v&&"pk.eyJ1IjoiZmFpc2FsbmtzYWlmIiwiYSI6ImNqYjVxbTBzNjM5bXgzMnM3aGhyODRjbGIifQ.5SWtkY-xfdtuKX7Jq2gV5g"||"";if(!i)return void(j.value="Map cannot load: missing Mapbox token.");if(window.mapboxgl.accessToken=i,M){try{M.remove()}catch{}M=null}M=new window.mapboxgl.Map({container:x.value,style:"mapbox://styles/mapbox/dark-v11",center:[77.5,12.5],zoom:0,maxZoom:0,attributionControl:!1,scrollZoom:!1,doubleClickZoom:!1,touchZoom:!0,dragPan:!1,dragRotate:!1,keyboard:!1}),M.on("load",()=>{P.value=!0;const a=new window.mapboxgl.LngLatBounds,e={type:"FeatureCollection",features:E.map(a=>({type:"Feature",properties:{name:a.name},geometry:{type:"Point",coordinates:a.coords}}))};E.forEach(e=>{a.extend(e.coords)}),M.addSource("active-circles",{type:"geojson",data:e}),M.addLayer({id:"active-circles-pulse",type:"circle",source:"active-circles",paint:{"circle-radius":10,"circle-color":"#aa8453","circle-opacity":.3,"circle-blur":.5}}),M.addLayer({id:"active-circles-layer",type:"circle",source:"active-circles",paint:{"circle-radius":3,"circle-color":"#aa8453","circle-opacity":.5,"circle-stroke-width":0,"circle-stroke-color":"#aa8453","circle-stroke-opacity":.8}});let o=4,r=!0;const i=()=>{r?(o+=.15,o>=7&&(r=!1)):(o-=.15,o<=4&&(r=!0)),M.setPaintProperty("active-circles-pulse","circle-radius",o),M.setPaintProperty("active-circles-pulse","circle-opacity",.4-.08*(o-4)),requestAnimationFrame(i)};i(),a.isEmpty()||M.fitBounds(a,{padding:10,maxZoom:0,duration:1200})}),M.on("error",a=>{j.value="Map failed to load. Please retry or check network."})}catch(r){j.value="Map initialization failed."}var a,e,o}return r(()=>{if(w.value){const a=new IntersectionObserver(([e])=>{e.isIntersecting&&!I.value&&(I.value=!0,a.unobserve(e.target))},{threshold:.1});a.observe(w.value)}C()}),i([I,P],([a,e])=>{a&&e&&M&&setTimeout(()=>{const a=Date.now(),e=B.value?8:6,o=B.value?7:6,r=()=>{const i=Date.now()-a,t=Math.min(i/1e3,1),n=t*o,c=t*e;M.setZoom(n),M.setMaxZoom(c),t<1&&requestAnimationFrame(r)};r()},100)}),t(()=>{M&&M.remove()}),(a,o)=>(c(),n("section",{ref_key:"sectionRef",ref:w,id:"active-areas",class:y(["active-areas-section",{"is-visible":I.value}])},[s("div",null,[s("div",k,[s("div",{ref_key:"mapContainer",ref:x,class:"map-container"},null,512),j.value?(c(),n("div",g,[s("p",h,m(j.value),1),d(e,{color:"primary",size:"small",class:"mt-4",onClick:C},{default:p(()=>[...o[0]||(o[0]=[u("Retry",-1)])]),_:1})])):l("",!0)])])],2))}},[["__scopeId","data-v-d616aa15"]]);export{f as default};
